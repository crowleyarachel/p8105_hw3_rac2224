---
title: "p8105_hw3_rac2224"
author: "Rachel Crowley"
date: "10/13/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1

```{r}
library(tidyverse)
library(ggridges)
library(knitr)
library(p8105.datasets)

data("instacart")
```

Describing the Dataset "instacart"

Dataset size and structure 

* The number of observations in the dataset instacart is `r nrow(instacart)`. The number of columns in the dataset instacart is `r ncol(instacart)`. The variables in the dataset instacart are `r names(instacart)`. The dimensions of the dataset instacart are `r dim(instacart)`. 
* The structure of the variables within the dataset instacart are as follows: order_id is an `r typeof(pull(instacart, order_id))`, product_id is an `r typeof(pull(instacart, product_id))`, add_to_cart_order is an `r typeof(pull(instacart, add_to_cart_order))`, reordered is an `r typeof(pull(instacart, reordered))`, user_id is an `r typeof(pull(instacart, user_id))`, eval_set is a `r typeof(pull(instacart, eval_set))`, order_number is an `r typeof(pull(instacart, order_number))`, order_dow is an `r typeof(pull(instacart, order_dow))`, order_hour_of_day is an `r typeof(pull(instacart, order_hour_of_day))`, days_since_prior_order is an `r typeof(pull(instacart, days_since_prior_order))`, product_name is a `r typeof(pull(instacart, product_name))`, aisle_id is an `r typeof(pull(instacart, aisle_id))`, department_id is an `r typeof(pull(instacart, department_id))`, aisle is a `r typeof(pull(instacart, aisle))`, and department is a `r typeof(pull(instacart, department))`.

Key variable description

* The min, max, mean, and median of each of the integer variables are as follows: for order_ID, the minimum is `r min(pull(instacart, order_id))`, the maximum is `r max(pull(instacart, order_id))`, the mean is `r mean(pull(instacart, order_id))`, and the median is `r median(pull(instacart, order_id))`; for product_ID, the minimum is `r min(pull(instacart, product_id))`, the maximum is `r max(pull(instacart, product_id))`, the mean is `r mean(pull(instacart, product_id))`, and the median is `r median(pull(instacart, product_id))`; for add_to_cart_order, the minimum is `r min(pull(instacart, add_to_cart_order))`, the maximum is `r max(pull(instacart, add_to_cart_order))`, the mean is `r mean(pull(instacart, add_to_cart_order))`, and the median is `r median(pull(instacart, add_to_cart_order))`; for reordered, the minimum is `r min(pull(instacart, reordered))`, the maximum is `r max(pull(instacart, reordered))`, the mean is `r mean(pull(instacart, reordered))`, and the median is `r median(pull(instacart, reordered))`; for user_id, the minimum is `r min(pull(instacart, user_id))`, the maximum is `r max(pull(instacart, user_id))`, the mean is `r mean(pull(instacart, user_id))`, and the median is `r median(pull(instacart, user_id))`; for order_number, the minimum is `r min(pull(instacart, order_number))`, the maximum is `r max(pull(instacart, order_number))`, the mean is `r mean(pull(instacart, order_number))`, and the median is `r median(pull(instacart, order_number))`; for order_dow, the minimum is `r min(pull(instacart, order_dow))`, the maximum is `r max(pull(instacart, order_dow))`, the mean is `r mean(pull(instacart, order_dow))`, and the median is `r median(pull(instacart, order_dow))`; for order_hour_of_day, the minimum is `r min(pull(instacart, order_hour_of_day))`, the maximum is `r max(pull(instacart, order_hour_of_day))`, the mean is `r mean(pull(instacart, order_hour_of_day))`, and the median is `r median(pull(instacart, order_hour_of_day))`; for days_since_prior_order, the minimum is `r min(pull(instacart, days_since_prior_order))`, the maximum is `r max(pull(instacart, days_since_prior_order))`, the mean is `r mean(pull(instacart, days_since_prior_order))`, and the median is `r median(pull(instacart, days_since_prior_order))`; for aisle_id, the minimum is `r min(pull(instacart, aisle_id))`, the maximum is `r max(pull(instacart, aisle_id))`, the mean is `r mean(pull(instacart, aisle_id))`, and the median is `r median(pull(instacart, aisle_id))`; and for department_id, the minimum is `r min(pull(instacart, department_id))`, the maximum is `r max(pull(instacart, department_id))`, the mean is `r mean(pull(instacart, department_id))`, and the median is `r median(pull(instacart, department_id))`. 
* The number of missing observations for each variable are as follows: for order_id is `r length(which(is.na(instacart$order_id)))`, for product_id is `r length(which(is.na(instacart$product_id)))`, for add_to_cart_order is `r length(which(is.na(instacart$add_to_cart_order)))`, for reordered is `r length(which(is.na(instacart$reordered)))`, for user_id is `r length(which(is.na(instacart$user_id)))`, for eval_set is `r length(which(is.na(instacart$eval_set)))`, for order_number is `r length(which(is.na(instacart$order_number)))`, for order_dow is `r length(which(is.na(instacart$order_dow)))`, for order_hour_of_day is `r length(which(is.na(instacart$order_hour_of_day)))`, for days_since_prior_order is `r length(which(is.na(instacart$days_since_prior_order)))`, for product_name is `r length(which(is.na(instacart$product_name)))`, for aisle_id is `r length(which(is.na(instacart$aisle_id)))`, for department_id is `r length(which(is.na(instacart$department_id)))`, for aisle is `r length(which(is.na(instacart$aisle)))`, and for department is `r length(which(is.na(instacart$department)))`.

Examples of observations

* The mean order hour of day for products from the produce department is `r mean(subset(instacart, department=='produce')$order_hour_of_day)`, the mean order hour of day for products from the frozen department is `r mean(subset(instacart, department=='frozen')$order_hour_of_day)`, and the mean order hour of day for products from the household department is `r mean(subset(instacart, department=='household')$order_hour_of_day)`. The largest number of days since prior order for an order that included something from the eggs aisle is `r max(subset(instacart, aisle =='eggs')$days_since_prior_order)` and for an order that included something from the coffee aisle is `r max(subset(instacart, aisle =='coffee')$days_since_prior_order)`.

Number of aisles and aisles with most items ordered

```{r}
instacart %>%
  count(aisle, n_distinct = n_distinct(aisle))%>%
  arrange(desc(n)) 
```

* There 134 unique aisles in the dataset "instacart". The aisles with most items ordered include the "fresh vegetables" aisle with 150609 orders, "fresh fruits" aisle with 150473 orders, the "packaged vegetables fruits" aisle with 78493 orders, the "yogurt" aisle with 55240 orders, and the "packaged cheese" aisle with 41699 orders. 

Plot for number of items ordered in each aisle

```{r}
instacart %>%
  count(aisle, n_distinct = n_distinct(aisle))%>%
  arrange(desc(n)) %>%
  filter(n >= 10000) %>%
    mutate(aisle = forcats::fct_reorder(aisle, n)) %>%
  ggplot(aes(x=aisle, y=(n))) + geom_point() + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
    labs(
      title = "Number of orders per aisle for aisles with 10,000 orders or more",
      x = "Aisle",
      y = "Number of orders",
      caption = "Data from Instacart"
    )
```

* Based on the plot created above, the aisles with most items ordered include the "fresh vegetables", "fresh fruits", "packaged vegetables fruits", "yogurt" and "packaged cheese" aisles, which supports previous conclusions made regarding the aisles with most items ordered. Fresh vegetables has the most items ordered, and butter has the least items ordered. The number of orders for the majority of aisles presented stays below 40,000, until there is a sharp and almost exponential increase in the number of orders seen for the aisles "fresh vegetables", "fresh fruits", "packaged vegetavles fruits", "yogurt" and "packaged cheese". 

Table showing the three most popular items in aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”


```{r}
instacart2 = instacart[which(instacart$aisle=='baking ingredients' | instacart$aisle == 'dog food care'| instacart$aisle == 'packaged vegetables fruits'), 1:15]
instacart3 = instacart[which(instacart$product_name=='Light Brown Sugar' | instacart$product_name=='Pure Baking Soda' | instacart$product_name=='Cane Sugar'| instacart$product_name=='Snack Sticks Chicken & Rice Recipe Dog Treats' | instacart$product_name=='Organix Chicken & Brown Rice Recipe' | instacart$product_name=='Small Dog Biscuits' | instacart$product_name=='Organic Baby Spinach' | instacart$product_name=='Organic Raspberries' | instacart$product_name=='Organic Blueberries'),1:15] 
instacart3 %>%
  group_by(aisle, product_name) %>%
  summarize(
    n_order = n()
  ) %>%
  arrange(desc(n_order)) %>%
  knitr::kable(caption = "Number of orders for top three ordered products in the 'packaged vegetables fruits', 'baking ingredients' and 'dog good care' aisles")
```

* The three most popular items in each aisle are as follows: for baking ingredients the items are Light Brown Sugar (n=499), Pure Baking Soda (n=387), and Cane Sugar (n=336); for dog food care the items are Snack Sticks Chicken & Rice Recipe Dog Treats (n=26), Organix Chicken & Brown Rice Recipe (n=28), and Small Dog Biscuits (n=26); for packaged vegetables fruits the items are Organic Baby Spinach (n=9784), Organic Raspberries (n=5546), Organic Blueberries (n=4966).

Table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week

```{r}
instacart4 = instacart[which(instacart$product_name=='Pink Lady Apples' | instacart$product_name == 'Coffee Ice Cream'), 1:15] %>%
 select(product_name, order_dow, order_hour_of_day)%>%
 group_by(order_dow, product_name) %>%
 summarize(mean_hour= mean(order_hour_of_day)) %>%
  pivot_wider(
    names_from = "order_dow",
    values_from = "mean_hour"
  )
colnames(instacart4)[colnames(instacart4)=="0"] <- "Sunday"
colnames(instacart4)[colnames(instacart4)=="1"] <- "Monday"
colnames(instacart4)[colnames(instacart4)=="2"] <- "Tuesday"
colnames(instacart4)[colnames(instacart4)=="3"] <- "Wednesday"
colnames(instacart4)[colnames(instacart4)=="4"] <- "Thursday"
colnames(instacart4)[colnames(instacart4)=="5"] <- "Friday"
colnames(instacart4)[colnames(instacart4)=="6"] <- "Saturday"
colnames(instacart4)[colnames(instacart4)=="product_name"] <- "Product Name"
instacart4 %>%
knitr::kable(caption = "Mean hour of day for order by product name and day of week" )
```

* For pink lady apples, the highest mean hour of day for an order is on Wednesday with a mean of 14.25 hours and the lowest mean hour of day for an order is on Monday with a mean of 11.36 hours. For coffee ice cream, the highest mean hour of day for an order is on Tuesday with a mean of 15.38 and the lowest mean hour of day for an order is on Friday with a mean of 12.26. 



